!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["webpack-google-cloud-storage-plugin"]=e():t["webpack-google-cloud-storage-plugin"]=e()}(global,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=9)}([function(t,e){t.exports=require("bluebird")},function(t,e,r){(function(t){var r=/^\[object .+?Constructor\]$/,n=/^(?:0|[1-9]\d*)$/,o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var i="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,u=i||a||Function("return this")(),c=e&&!e.nodeType&&e,s=c&&"object"==typeof t&&t&&!t.nodeType&&t,f=s&&s.exports===c,l=f&&i.process,p=function(){try{var t=s&&s.require&&s.require("util").types;return t||l&&l.binding&&l.binding("util")}catch(t){}}(),h=p&&p.isTypedArray;function y(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var d,v,b,g=Array.prototype,_=Function.prototype,m=Object.prototype,w=u["__core-js_shared__"],j=_.toString,O=m.hasOwnProperty,x=(d=/[^.]+$/.exec(w&&w.keys&&w.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"",E=m.toString,k=j.call(Object),P=RegExp("^"+j.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),S=f?u.Buffer:void 0,L=u.Symbol,F=u.Uint8Array,A=S?S.allocUnsafe:void 0,T=(v=Object.getPrototypeOf,b=Object,function(t){return v(b(t))}),z=Object.create,N=m.propertyIsEnumerable,I=g.splice,C=L?L.toStringTag:void 0,G=function(){try{var t=ct(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),R=S?S.isBuffer:void 0,M=Math.max,U=Date.now,q=ct(u,"Map"),$=ct(Object,"create"),D=function(){function t(){}return function(e){if(!mt(e))return{};if(z)return z(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function W(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function B(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function V(t){var e=this.__data__=new B(t);this.size=e.size}function H(t,e){var r=dt(t),n=!r&&yt(t),o=!r&&!n&&bt(t),i=!r&&!n&&!o&&jt(t),a=r||n||o||i,u=a?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=u.length;for(var s in t)!e&&!O.call(t,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||st(s,c))||u.push(s);return u}function J(t,e,r){(void 0!==r&&!ht(t[e],r)||void 0===r&&!(e in t))&&X(t,e,r)}function K(t,e,r){var n=t[e];O.call(t,e)&&ht(n,r)&&(void 0!==r||e in t)||X(t,e,r)}function Q(t,e){for(var r=t.length;r--;)if(ht(t[r][0],e))return r;return-1}function X(t,e,r){"__proto__"==e&&G?G(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}W.prototype.clear=function(){this.__data__=$?$(null):{},this.size=0},W.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},W.prototype.get=function(t){var e=this.__data__;if($){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return O.call(e,t)?e[t]:void 0},W.prototype.has=function(t){var e=this.__data__;return $?void 0!==e[t]:O.call(e,t)},W.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=$&&void 0===e?"__lodash_hash_undefined__":e,this},B.prototype.clear=function(){this.__data__=[],this.size=0},B.prototype.delete=function(t){var e=this.__data__,r=Q(e,t);return!(r<0)&&(r==e.length-1?e.pop():I.call(e,r,1),--this.size,!0)},B.prototype.get=function(t){var e=this.__data__,r=Q(e,t);return r<0?void 0:e[r][1]},B.prototype.has=function(t){return Q(this.__data__,t)>-1},B.prototype.set=function(t,e){var r=this.__data__,n=Q(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},Y.prototype.clear=function(){this.size=0,this.__data__={hash:new W,map:new(q||B),string:new W}},Y.prototype.delete=function(t){var e=ut(this,t).delete(t);return this.size-=e?1:0,e},Y.prototype.get=function(t){return ut(this,t).get(t)},Y.prototype.has=function(t){return ut(this,t).has(t)},Y.prototype.set=function(t,e){var r=ut(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},V.prototype.clear=function(){this.__data__=new B,this.size=0},V.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},V.prototype.get=function(t){return this.__data__.get(t)},V.prototype.has=function(t){return this.__data__.has(t)},V.prototype.set=function(t,e){var r=this.__data__;if(r instanceof B){var n=r.__data__;if(!q||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(t,e),this.size=r.size,this};var Z,tt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),a=i.length;a--;){var u=i[Z?a:++n];if(!1===e(o[u],u,o))break}return t};function et(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":C&&C in Object(t)?function(t){var e=O.call(t,C),r=t[C];try{t[C]=void 0;var n=!0}catch(t){}var o=E.call(t);n&&(e?t[C]=r:delete t[C]);return o}(t):function(t){return E.call(t)}(t)}function rt(t){return wt(t)&&"[object Arguments]"==et(t)}function nt(t){return!(!mt(t)||function(t){return!!x&&x in t}(t))&&(gt(t)?P:r).test(function(t){if(null!=t){try{return j.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function ot(t){if(!mt(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=ft(t),r=[];for(var n in t)("constructor"!=n||!e&&O.call(t,n))&&r.push(n);return r}function it(t,e,r,n,o){t!==e&&tt(e,(function(i,a){if(o||(o=new V),mt(i))!function(t,e,r,n,o,i,a){var u=lt(t,r),c=lt(e,r),s=a.get(c);if(s)return void J(t,r,s);var f=i?i(u,c,r+"",t,e,a):void 0,l=void 0===f;if(l){var p=dt(c),h=!p&&bt(c),y=!p&&!h&&jt(c);f=c,p||h||y?dt(u)?f=u:wt(_=u)&&vt(_)?f=function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(u):h?(l=!1,f=function(t,e){if(e)return t.slice();var r=t.length,n=A?A(r):new t.constructor(r);return t.copy(n),n}(c,!0)):y?(l=!1,d=c,v=!0?(b=d.buffer,g=new b.constructor(b.byteLength),new F(g).set(new F(b)),g):d.buffer,f=new d.constructor(v,d.byteOffset,d.length)):f=[]:function(t){if(!wt(t)||"[object Object]"!=et(t))return!1;var e=T(t);if(null===e)return!0;var r=O.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&j.call(r)==k}(c)||yt(c)?(f=u,yt(u)?f=function(t){return function(t,e,r,n){var o=!r;r||(r={});var i=-1,a=e.length;for(;++i<a;){var u=e[i],c=n?n(r[u],t[u],u,r,t):void 0;void 0===c&&(c=t[u]),o?X(r,u,c):K(r,u,c)}return r}(t,Ot(t))}(u):mt(u)&&!gt(u)||(f=function(t){return"function"!=typeof t.constructor||ft(t)?{}:D(T(t))}(c))):l=!1}var d,v,b,g;var _;l&&(a.set(c,f),o(f,c,n,i,a),a.delete(c));J(t,r,f)}(t,e,a,r,it,n,o);else{var u=n?n(lt(t,a),i,a+"",t,e,o):void 0;void 0===u&&(u=i),J(t,a,u)}}),Ot)}function at(t,e){return pt(function(t,e,r){return e=M(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=M(n.length-e,0),a=Array(i);++o<i;)a[o]=n[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=n[o];return u[e]=r(a),y(t,this,u)}}(t,e,kt),t+"")}function ut(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function ct(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return nt(r)?r:void 0}function st(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}function ft(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||m)}function lt(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var pt=function(t){var e=0,r=0;return function(){var n=U(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(G?function(t,e){return G(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:kt);function ht(t,e){return t===e||t!=t&&e!=e}var yt=rt(function(){return arguments}())?rt:function(t){return wt(t)&&O.call(t,"callee")&&!N.call(t,"callee")},dt=Array.isArray;function vt(t){return null!=t&&_t(t.length)&&!gt(t)}var bt=R||function(){return!1};function gt(t){if(!mt(t))return!1;var e=et(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function _t(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function mt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function wt(t){return null!=t&&"object"==typeof t}var jt=h?function(t){return function(e){return t(e)}}(h):function(t){return wt(t)&&_t(t.length)&&!!o[et(t)]};function Ot(t){return vt(t)?H(t,!0):ot(t)}var xt,Et=(xt=function(t,e,r){it(t,e,r)},at((function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=xt.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!mt(r))return!1;var n=typeof e;return!!("number"==n?vt(r)&&st(e,r.length):"string"==n&&e in r)&&ht(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var a=e[r];a&&xt(t,a,r,o)}return t})));function kt(t){return t}t.exports=Et}).call(this,r(5)(t))},function(t,e){t.exports=require("@google-cloud/storage")},function(t,e){t.exports=require("path")},function(t,e,r){t.exports=r(7)()},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=require("recursive-readdir")},function(t,e,r){"use strict";var n=r(8);function o(){}function i(){}i.resetWarningCache=o,t.exports=function(){function t(t,e,r,o,i,a){if(a!==n){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}function e(){return t}t.isRequired=t;var r={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},function(t,e,r){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(t,e,r){"use strict";r.r(e);var n=r(0),o=r.n(n),i=r(4),a=r.n(i),u=r(1),c=r.n(u),s=r(2),f=r(3),l=r.n(f);function p(t,e){return e.reduce((function(e,r){return Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]),e}),{})}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */y=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),u=new A(n||[]);return o(a,"_invoke",{value:P(t,r,u)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p="suspendedStart",d="executing",v="completed",b={};function g(){}function _(){}function m(){}var w={};s(w,a,(function(){return this}));var j=Object.getPrototypeOf,O=j&&j(j(T([])));O&&O!==r&&n.call(O,a)&&(w=O);var x=m.prototype=g.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(o,i,a,u){var c=l(t[o],t,i);if("throw"!==c.type){var s=c.arg,f=s.value;return f&&"object"==h(f)&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){s.value=t,a(s)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=S(u,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===p)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var s=l(e,r,n);if("normal"===s.type){if(o=n.done?v:"suspendedYield",s.arg===b)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(o=v,n.method="throw",n.arg=s.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var i=l(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,b;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function F(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(h(e)+" is not iterable")}return _.prototype=m,o(x,"constructor",{value:m,configurable:!0}),o(m,"constructor",{value:_,configurable:!0}),_.displayName=s(m,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},E(k.prototype),s(k.prototype,u,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new k(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(x),s(x,c,"Generator"),s(x,a,(function(){return this})),s(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(F),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),s=n.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),F(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;F(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function d(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){d(i,n,o,a,u,"next",t)}function u(t){d(i,n,o,a,u,"throw",t)}a(void 0)}))}}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_(n.key),n)}}function _(t){var e=function(t,e){if("object"!=h(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=h(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==h(e)?e:e+""}var m=o.a.promisify(r(6)),w="WebpackGoogleCloudStoragePlugin",j=function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b(this,t),a.a.validateWithErrors(this.constructor.schema,e,w),this.isConnected=!1,this.storageOptions=e.storageOptions,this.uploadOptions=e.uploadOptions,this.uploadOptions.destinationNameFn=this.uploadOptions.destinationNameFn||this.constructor.defaultDestinationNameFn,this.uploadOptions.metadataFn=this.uploadOptions.metadataFn||this.constructor.defaultMetadataFn,this.options=p(e,["directory","include","exclude","basePath"]),this.options.exclude=(this.options.exclude||[]).map((function(t){return new RegExp(t)})),this.options.include=(this.options.include||[]).map((function(t){return new RegExp(t)}))},(e=[{key:"connect",value:(f=v(y().mark((function t(){return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isConnected){t.next=2;break}return t.abrupt("return");case 2:this.client=new s.Storage(c()(this.storageOptions,{promise:o.a})),this.isConnected=!0;case 4:case"end":return t.stop()}}),t,this)}))),function(){return f.apply(this,arguments)})},{key:"filterFiles",value:(u=v(y().mark((function t(e){var r=this;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.filter((function(t){return r.isIncluded(t.name)&&!r.isExcluded(t.name)&&!r.isIgnored(t.name)})));case 1:case"end":return t.stop()}}),t)}))),function(t){return u.apply(this,arguments)})},{key:"handleFiles",value:(i=v(y().mark((function t(e){var r;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.filterFiles(e);case 2:return r=t.sent,t.abrupt("return",this.uploadFiles(r));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"apply",value:function(t){var e=this;this.connect(),t.hooks.afterEmit.tapAsync(w,function(){var t=v(y().mark((function t(r,n){var o,i;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m(e.options.directory,e.options.exclude.map(e.constructor.regexpToIgnoreFunction));case 3:return o=t.sent,i=o.map((function(t){return{name:l.a.basename(t),path:t}})),t.next=7,e.handleFiles(i);case 7:n(),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(0),r.errors.push(new Error("".concat(w,": ").concat(t.t0.stack))),n();case 14:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e,r){return t.apply(this,arguments)}}())}},{key:"uploadFiles",value:(n=v(y().mark((function t(){var e,r,n,i=this,a=arguments;return y().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:[],r=this.client.bucket(this.uploadOptions.bucketName),n=e.map((function(t){return r.upload(t.path,{destination:i.uploadOptions.destinationNameFn(t),gzip:i.uploadOptions.gzip||!1,public:i.uploadOptions.makePublic||!1,resumable:i.uploadOptions.resumable,metadata:i.uploadOptions.metadataFn(t)})})),t.abrupt("return",o.a.all(n));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}])&&g(t.prototype,e),r&&g(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,u,f}();e.default=j}])}));